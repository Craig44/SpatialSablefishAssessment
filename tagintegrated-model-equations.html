<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>TagIntegrated model equations | SpatialSablefishAssessment</title>
  <meta name="description" content="This Gitbook describes the spatial sablefish stock assessment R package and how to use it" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="TagIntegrated model equations | SpatialSablefishAssessment" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This Gitbook describes the spatial sablefish stock assessment R package and how to use it" />
  <meta name="github-repo" content="https://github.com/Craig44/SpatialSablefishAssessment" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="TagIntegrated model equations | SpatialSablefishAssessment" />
  
  <meta name="twitter:description" content="This Gitbook describes the spatial sablefish stock assessment R package and how to use it" />
  

<meta name="author" content="C.Marsh" />


<meta name="date" content="2023-07-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="how-to-use-spatialsablefishassessment.html"/>
<link rel="next" href="tagintegrated-data-and-parameter-descriptions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SpatialSablefishAssessment</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><i class="fa fa-check"></i>A list of functions available in the <code>SpatialSablefishAssessment</code> package</a>
<ul>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#validate-functions"><i class="fa fa-check"></i>Validate functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#accessor-functions"><i class="fa fa-check"></i>Accessor functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#plotting-functions"><i class="fa fa-check"></i>Plotting functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#estimation-functions"><i class="fa fa-check"></i>Estimation functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#projectionreference-point-functions"><i class="fa fa-check"></i>Projection/Reference point functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#model-comparison-functions"><i class="fa fa-check"></i>Model comparison functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#distribution-functions"><i class="fa fa-check"></i>Distribution functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#parameter-transformation-functions"><i class="fa fa-check"></i>Parameter transformation functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#data-grooming-functions"><i class="fa fa-check"></i>Data grooming functions</a></li>
<li class="chapter" data-level="" data-path="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html"><a href="a-list-of-functions-available-in-the-spatialsablefishassessment-package.html#auxillary-functions"><i class="fa fa-check"></i>Auxillary functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html"><i class="fa fa-check"></i>How to use <code>SpatialSablefishAssessment</code></a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#configuring-and-checking-model-inputs-data-and-parameters"><i class="fa fa-check"></i>Configuring and checking model inputs (data and parameters)</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#simple-sanity-checks"><i class="fa fa-check"></i>Simple sanity checks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#optimisation"><i class="fa fa-check"></i>Optimisation</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#check-convergence"><i class="fa fa-check"></i>Check convergence</a></li>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#fixing-estimable-parameters-at-input-values"><i class="fa fa-check"></i>Fixing estimable parameters at input values</a></li>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#sharing-parameter-estimates-among-estimable-variables-i.e.-male-and-female-having-a-common-selectivity"><i class="fa fa-check"></i>Sharing parameter estimates among estimable variables i.e., male and female having a common selectivity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment.html"><a href="how-to-use-spatialsablefishassessment.html#model-summary"><i class="fa fa-check"></i>Model Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html"><i class="fa fa-check"></i><code>TagIntegrated</code> model equations</a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#process-equations"><i class="fa fa-check"></i>Process equations</a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#population-dynamics"><i class="fa fa-check"></i>Population dynamics</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#initialisation"><i class="fa fa-check"></i>Initialisation</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#growth"><i class="fa fa-check"></i>Growth</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#recruitment"><i class="fa fa-check"></i>Recruitment</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#spawning-biomass"><i class="fa fa-check"></i>Spawning biomass</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#fishing-mortality"><i class="fa fa-check"></i>Fishing mortality</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#tag-release-events"><i class="fa fa-check"></i>Tag release events</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#selectivities"><i class="fa fa-check"></i>Selectivities</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#observation-equations"><i class="fa fa-check"></i>Observation equations</a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#catch-at-age"><i class="fa fa-check"></i>Catch at age</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#catch-at-length"><i class="fa fa-check"></i>Catch at length</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#proportions-at-age"><i class="fa fa-check"></i>Proportions at age</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#relative-abundance-indices"><i class="fa fa-check"></i>Relative abundance indices</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#tag-recovery-observations"><i class="fa fa-check"></i>Tag recovery observations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#likelihood-formulations"><i class="fa fa-check"></i>Likelihood formulations</a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#multinomial"><i class="fa fa-check"></i>Multinomial</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#dirichlet-multinomial"><i class="fa fa-check"></i>Dirichlet-Multinomial</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#lognormal"><i class="fa fa-check"></i>Lognormal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#projecting"><i class="fa fa-check"></i>Projecting</a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#recruitment-1"><i class="fa fa-check"></i>Recruitment</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#fishing"><i class="fa fa-check"></i>Fishing</a></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#example-code-snippets"><i class="fa fa-check"></i>Example code snippets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-model-equations.html"><a href="tagintegrated-model-equations.html#symbol-notation"><i class="fa fa-check"></i>Symbol Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-data-and-parameter-descriptions.html"><a href="tagintegrated-data-and-parameter-descriptions.html"><i class="fa fa-check"></i><code>TagIntegrated</code> <code>data</code> and <code>parameter</code> descriptions</a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-data-and-parameter-descriptions.html"><a href="tagintegrated-data-and-parameter-descriptions.html#data"><i class="fa fa-check"></i><code>data</code></a>
<ul>
<li class="chapter" data-level="" data-path="tagintegrated-data-and-parameter-descriptions.html"><a href="tagintegrated-data-and-parameter-descriptions.html#additional-data-inputs-for-tagintegratedvalidate"><i class="fa fa-check"></i>Additional data inputs for <code>TagIntegratedValidate</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagintegrated-data-and-parameter-descriptions.html"><a href="tagintegrated-data-and-parameter-descriptions.html#parameters"><i class="fa fa-check"></i><code>parameters</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="assessment-data-and-parameter-descriptions.html"><a href="assessment-data-and-parameter-descriptions.html"><i class="fa fa-check"></i><code>Assessment</code> <code>data</code> and <code>parameter</code> descriptions</a>
<ul>
<li class="chapter" data-level="" data-path="assessment-data-and-parameter-descriptions.html"><a href="assessment-data-and-parameter-descriptions.html#data-1"><i class="fa fa-check"></i><code>data</code></a></li>
<li class="chapter" data-level="" data-path="assessment-data-and-parameter-descriptions.html"><a href="assessment-data-and-parameter-descriptions.html#parameters-1"><i class="fa fa-check"></i><code>parameters</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-spatialsablefishassessment-in-a-mse.html"><a href="how-to-use-spatialsablefishassessment-in-a-mse.html"><i class="fa fa-check"></i>How to use <code>SpatialSablefishAssessment</code> in a MSE</a></li>
<li class="chapter" data-level="" data-path="contributing-to-spatialsablefishassessment.html"><a href="contributing-to-spatialsablefishassessment.html"><i class="fa fa-check"></i>Contributing to <code>SpatialSablefishAssessment</code></a>
<ul>
<li class="chapter" data-level="" data-path="contributing-to-spatialsablefishassessment.html"><a href="contributing-to-spatialsablefishassessment.html#adding-a-new-r-dependency"><i class="fa fa-check"></i>Adding a new R dependency</a></li>
<li class="chapter" data-level="" data-path="contributing-to-spatialsablefishassessment.html"><a href="contributing-to-spatialsablefishassessment.html#tips"><i class="fa fa-check"></i>Tips</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/Craig44/SpatialSablefishAssessment" target="blank">Github Repo here</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SpatialSablefishAssessment</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tagintegrated-model-equations" class="section level1 unnumbered hasAnchor">
<h1><code>TagIntegrated</code> model equations<a href="tagintegrated-model-equations.html#tagintegrated-model-equations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="process-equations" class="section level2 unnumbered hasAnchor">
<h2>Process equations<a href="tagintegrated-model-equations.html#process-equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="population-dynamics" class="section level3 unnumbered hasAnchor">
<h3>Population dynamics<a href="tagintegrated-model-equations.html#population-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The order of processes in an annual cycle follow</p>
<ol style="list-style-type: decimal">
<li>recruitment and release of tagged fish (we apply initial tag induced mortality here),</li>
<li>total mortality and ageing,</li>
<li>markovian movement</li>
<li>annual tag shedding (applied as a mortality process),</li>
</ol>
<p>Before movement, the partition is updated following
<span class="math display">\[\begin{align*}
N_{a,r,y,s} =
\begin{cases}
R_{r,y} p^R_{s,y}, &amp; a = a_1\\
N_{a - 1,r,y - 1,s} \exp\bigg( -Z_{a - 1,r, y - 1,s} \bigg), &amp; a_1 &lt; a &lt; a_+\\
N_{a - 1,r,y - 1,s} \exp\bigg( -Z_{a - 1,r, y - 1,s} \bigg) + N_{a,r,y - 1,s} \exp\bigg( -Z_{a,r, y - 1,s} \bigg), &amp;  a = a_+
\end{cases}
\end{align*}\]</span></p>
<p><span class="math inline">\(p^R_{s,y}\)</span> is proportion recruits for sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(y\)</span> and movement is then applied</p>
<p><span class="math display">\[\begin{equation*}
\boldsymbol{N}&#39;_{a,y,s} = \boldsymbol{N}_{a,y,s} \boldsymbol{M} \ \ \forall \ a
\end{equation*}\]</span></p>
<p>where, <span class="math inline">\(\boldsymbol{N}&#39;_{a,y,s} = (N&#39;_{a,1,y,s}, \dots, N&#39;_{a,n_r,y,s})\)</span> denotes the numbers for age <span class="math inline">\(a\)</span> across all regions after movement and <span class="math inline">\(\boldsymbol{M}\)</span> is an <span class="math inline">\(n_r \times n_r\)</span> movement matrix, which will move age cohort <span class="math inline">\(a\)</span> among the regions based on the movement matrix.</p>
<p>** An important input is whether movement occurs to new recruits, which is specified by the input <code>do_recruits_move</code>. If <code>do_recruits_move == 0</code> i.e., they don’t get movement applied. In the code this applied by applying movement and then resetting the numbers at age by the recruited values.</p>
</div>
<div id="initialisation" class="section level3 unnumbered hasAnchor">
<h3>Initialisation<a href="tagintegrated-model-equations.html#initialisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An equilibrium age structure is derived by iterating the annual cycle is run <span class="math inline">\(n_a - 1\)</span> times (i.e., to populate all age cohorts prior to the plus group). Then, iterate the annual cycle one more time and calculate the number of individuals that moved into each regions plus age cohort, denoted by <span class="math inline">\(c^r_{a+}\)</span>. This will be the result of ageing, mortality and movement. The equilibrium plus group for region <span class="math inline">\(r\)</span> is then calculated as</p>
<p><span class="math display">\[
N_{a+, r} = N_{a+ - 1, r} \frac{1}{1 - c^r_{a+}}  \  .
\]</span></p>
<p>After the equilibrium age-structure is calculated, there is an option to estimate global or region specific deviations to allow the model to start with a non-equilibrium age-structure</p>
<p><span class="math display">\[
N_{a, r} = N_{a, r} e^{\psi_a} \ \ \forall \ r \ \&amp; \forall a \in (a_{min} + 1, \dots, a_{max} - 1)
\]</span>
These estimatble intiial age-deviations are not applied on the first or last age cohort. This is what is done in the current Sablefish assessment, I think it has something to do with helping estimation of <span class="math inline">\(R_0\)</span> and such. There is the ability to estimate less age-deviations than age using <code>data$n_init_rec_devs</code>. If there are 30 age-cohorts in the model you can set up initial age-deviations so only 15 are estimated with ages 16-29 getting applied the same last <span class="math inline">\(e^{\psi_a}\)</span> value.</p>
<p>To help with estimation, there is a penalty on <span class="math inline">\(\psi_a\)</span> that assumes a central tendancy of zero with an estimable variance parameter (<span class="math inline">\(\sigma_{\psi}^2\)</span>).
<span class="math display">\[
\psi_a \sim \mathcal{N}(0, \sigma_{\psi})
\]</span></p>
<p>In general these parameters can be highly uncertain. The variance on these deviation parameters is often fixed at a low value which requires a strong signal in the data to deviate away from the initial equilibrium age-structure.</p>
<p>You can also apply/estimate additional fishing mortality during the initial equilibrium calculation denoted by <span class="math inline">\(F^{init}_{a,s}\)</span> for age <span class="math inline">\(a\)</span> and sex <span class="math inline">\(s\)</span>. If <code>F_method = 0</code> then
<span class="math display">\[
F^{init}_{a,s} = F^{fixed} S_{a,s}^{fixed} p_{hist}
\]</span>
where, <span class="math inline">\(F^{fixed}\)</span> is the average annual fishing mortality for the fixed gear (<code>ln_fixed_F_avg</code>), <span class="math inline">\(S_{a,s}^{fixed}\)</span> is the fixed gear selectivity in the first time-block and <span class="math inline">\(p_{hist}\)</span> is an input value that specifies the proportion of average longline fishing mortality to apply during initialisation. If <code>F_method = 1</code> then
<span class="math display">\[
F^{init} =  \widehat{F}^{init}S_{a,s}^{fixed} p_{hist}
\]</span>
where, <span class="math inline">\(\widehat{F}^{init}\)</span> is the estimable parameter <code>ln_init_F_avg</code>. It is advised to set <span class="math inline">\(p_{hist} = 1.0\)</span> so that the estimated parameter has a natural interpretation.</p>
<p>There are two initial biomass quantities that are reported, these are <code>Bzero</code> and <code>Binit</code>. <code>Bzero</code> is the spawning biomass from a population that has been exposed to natural mortality, recruitment (<span class="math inline">\(R_0\)</span>), and movement only. <code>Binit</code> is the spawning biomass from a population that has been exposed to natural mortality and initial fishing mortality (<span class="math inline">\(F^{init}\)</span>), recruitment (<span class="math inline">\(R_0\)</span>), and movement.</p>
</div>
<div id="growth" class="section level3 unnumbered hasAnchor">
<h3>Growth<a href="tagintegrated-model-equations.html#growth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Empirical length at age matrices are supplied for all years where sufficient age-length data was available and growth was assumed the same across all regions. Mean weight at age is also an user input. Growth cannot vary across regions in the current models, so users must supply length at age matrices and weight at age vectors for each year, age and sex in the model.</p>
</div>
<div id="recruitment" class="section level3 unnumbered hasAnchor">
<h3>Recruitment<a href="tagintegrated-model-equations.html#recruitment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How to spatially apportion recruits in a way that is consistent with the data and isn’t confounded with movement of young fish? There are two considerations, firstly looking at the AF and LFs there are regions that seem to have more young fish than others (link to figure and describe). However, there is very little information on spawning grounds and behavior. This coupled with a complex early life history make it difficult to a priori set regional apportionment of recruits, which would be ideal, an alternative is to estimate these as free parameters. This may introduce confounding when we start estimating movement which is believed to be ontogenetic.</p>
<p>Terminology regarding recruitment and spatial population structures can be ambiguous and confusing. There is a fair bit of literature describing and comparing metapopulations, panmictic populations and spatially heterogeneous populations. I believe this model can represent the later two A metapopulation implies there is some natal identifiability when fish are mixing which this model doesn’t do. However, this would only be advantageous when there is some sort of natal dynamic e.g. natal homing or natal productivity difference such as growth. Neither of these are really evident in the observed data for sablefish and so having a natal attribute in the partition doesn’t make much sense.</p>
</div>
<div id="spawning-biomass" class="section level3 unnumbered hasAnchor">
<h3>Spawning biomass<a href="tagintegrated-model-equations.html#spawning-biomass" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Spawning biomass is based on mature female weight. SSB in a given year and region is calculated as,</p>
<p><span class="math display">\[
SSB_{y,r} \sum\limits_a N_{a,s = 2, r, y} exp(-Z_{a,s = 2, r, y})^{prop_Z} S^{mat}_{a,y} \bar{w}_{a,s = 2, y}
\]</span></p>
<p>where, <span class="math inline">\(s = 2\)</span> denotes the female sex, <span class="math inline">\(S^{mat}_{a,y}\)</span> is the maturity at age, <span class="math inline">\(\bar{w}_{a,s = 2, y}\)</span> is female mean weight at age and <span class="math inline">\(prop_Z\)</span> indicates the proportion of total mortality applied before SSB is calculated.</p>
</div>
<div id="fishing-mortality" class="section level3 unnumbered hasAnchor">
<h3>Fishing mortality<a href="tagintegrated-model-equations.html#fishing-mortality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the hybrid <span class="math inline">\(F\)</span> method is assumed, tagged fish were not included when internally solving the fishing mortality nuisance parameters. The ratio of tagged to untagged numbers of fish in the partition in any year was assumed to be small enough not to effect <span class="math inline">\(F\)</span> estimates. However, tagged fish were included when the model calculates predicted catch-at-age/length and catch for a fleet. This decision was made to reduce the computational overhead this would require to implement. When <span class="math inline">\(F\)</span> parameters are estimated as free parameters, then this is not a problem and <span class="math inline">\(F\)</span> will be applied to both tagged and untagged fish.</p>
</div>
<div id="tag-release-events" class="section level3 unnumbered hasAnchor">
<h3>Tag release events<a href="tagintegrated-model-equations.html#tag-release-events" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tags release event denoted by the index <span class="math inline">\(k\)</span> have an implied region <span class="math inline">\(r\)</span> and year <span class="math inline">\(y\)</span> dimension. Each tag release event has known sex and age frequency at release. Often tagging data has only length at release information, we have used age-length keys to convert numbers at length of release to numbers at age and sex at release that are then input into the model (<code>data$male_tagged_cohorts_by_age</code> and <code>data$female_tagged_cohorts_by_age</code>). Tagged fish from release event <span class="math inline">\(k\)</span> are denoted in the partition by <span class="math inline">\(N^k_{a,r,y,s}\)</span>, and are tracked for <span class="math inline">\(n_{T}\)</span> (<code>data$n_years_to_retain_tagged_cohorts_for</code>) years before migrating into an accumulation tag group, at which point we loose release-year information but do maintain release region. At present, tagged fish are assumed to take on the exact same population processes as the untagged elements of the partition i.e., no mixing periods.</p>
<ul>
<li>Something to consider, given there is uncertainty in the age-length key method, when converting numbers at length to numbers at age and sex and the numbers of tag-releases are assumed known without error. Consider rerunning the model with bootstrapped tag releases from bootstrapped age-length keys. This will give you an indication of the uncertainty the model has to this input assumption.</li>
</ul>
</div>
<div id="selectivities" class="section level3 unnumbered hasAnchor">
<h3>Selectivities<a href="tagintegrated-model-equations.html#selectivities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Describe the functional forms available in the models. The selectivity component is quite modular and you can easily add a new selectivity function in the <a href="https://github.com/Craig44/SpatialSablefishAssessment/blob/master/inst/include/SetupSelectivities.hpp">source code here</a>. There are three selectivities in the model one for the survey and two for the fisheries. Selectivities types are set by the model data objects ending with <code>sel_type</code> e.g., <code>fixed_sel_type</code>, <code>trwl_sel_type</code> and <code>srv_dom_ll_sel_type</code>. These objects are vectors each element defines a selectivity type that is applied in a time-block. The time-block is defined by the corresponding <code>sel_by_year_indicator</code> objects. The following is an example of how to specify and interpret these containers. Say <code>data$years = c(1990, 1991, 1992, 1993)</code> and we were not interested in doing projections (require more elements in <code>sel_by_year_indicator</code> objects). Say we wanted to have 1990 and 1991 have one logistic selectivity and then 1992 and 1993 to have seperate logistic selectivity for the fixed gear fishery, you would specify the containers as</p>
<ul>
<li><code>data$fixed_sel_type = c(0, 0)</code></li>
<li><code>data$fixed_sel_by_year_indicator = c(0, 0, 1, 1)</code> this points each model year to a selectivity in <code>data$fixed_sel_type</code></li>
</ul>
<p>Selectivity types are</p>
<ul>
<li><p><code>0</code> Logistic
<span class="math display">\[
S(a | \theta_1, \theta_2) = \frac{1}{1 + \exp(-\theta_2 \times (a - \theta_1)}
\]</span></p></li>
<li><p><code>1</code> Double normal - Punt et. al 1996 gamma parameterization (that is a comment from the ADMB assessment code)
<span class="math display">\[
S(a | \theta_1, \theta_2) = \frac{a}{\theta_1}^{\theta_1/0.5\sqrt{\theta_1^2 + 4\theta_2^2}} exp\left(\frac{\theta_1 - a}{0.5 \left( \sqrt{\theta_1^2 + 4\theta_2^2} - \theta_1 \right)} \right)
\]</span></p></li>
<li><p><code>2</code> power function (Be careful with this selectivity, if your min age is not = 1. Then I don’t think you will end up with a max selectivity value of 1)
<span class="math display">\[
S(a | \theta_1) = \frac{1}{a ^{\theta_1}}
\]</span></p></li>
<li><p><code>3</code> Alternative logistic
<span class="math display">\[
S(a | \theta_1, \theta_2) = \frac{1}{1 + 19^{(\theta_1 - a) / \theta_2}}
\]</span></p></li>
<li><p><code>4</code> Exponential decay
<span class="math display">\[
S(a | \theta_1) =  exp(-a * \theta_1);
\]</span></p></li>
<li><p><code>5</code> Double normal 3 parameterisation, where <span class="math inline">\(\boldsymbol{\theta} = (\theta_1, \theta_2, \theta_3) = (\mu, \sigma_r, \sigma_l)\)</span>, where <span class="math inline">\(\mu\)</span> is the age that the selectivity = 1, <span class="math inline">\(\sigma_r\)</span> is the standard deviation for the right hand side of the selectivity curve and <span class="math inline">\(\sigma_l\)</span> is the standard deviation for the left hand side of the selectivity curve
<span class="math display">\[
S(a | \mu, \sigma_r, \sigma_l) = j_a \exp\left(\log(0.5) \left(\frac{a - \mu}{\sigma_r^2}\right)^2\right) + \left( 1 - j_a \right)\exp\left(\log(0.5) \left(\frac{a - \mu}{\sigma_l^2}\right)^2\right)
\]</span>
where,
<span class="math display">\[
j_a = 1 / \left(1 + \exp\{-5(a - \mu)\}\right)
\]</span></p></li>
</ul>
</div>
</div>
<div id="observation-equations" class="section level2 unnumbered hasAnchor">
<h2>Observation equations<a href="tagintegrated-model-equations.html#observation-equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are five observation types available in the <code>TagIntegrated</code> model</p>
<ul>
<li>Relative indices of abundance from a longline survey (its called longline survey but could be any survey)</li>
<li>Age composition disaggregated by sex for the fixed gear fishery and longline survey</li>
<li>Length composition disaggregated by sex for the trawl and fixed gear fishery</li>
<li>Annual observed catch by fishery</li>
<li>Tag recoveries from the fixed gear fishery</li>
</ul>
<div id="catch-at-age" class="section level3 unnumbered hasAnchor">
<h3>Catch at age<a href="tagintegrated-model-equations.html#catch-at-age" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fishery dependent catch at age observations are available for the fixed gear fishery, but are also needed to calculate catch at length observations for the trawl fishery. Catch at age for fishery <span class="math inline">\(g\)</span> is denoted by <span class="math inline">\({C}^g_{a,r,y,s}\)</span> and model fitted values are calculated following</p>
<p><span class="math display">\[\begin{equation}
  {C}^g_{a,r,y,s} = \frac{F^g_{a,r,y,s}}{Z_{a,r,y,s}}   N_{a,r,y,s} \left(1 - S_{a,r,y,s} \right)
\end{equation}\]</span></p>
<p>Observed values were proportions with respect to age and sex, final model fitted proportions were
<span class="math display">\[
{P}^g_{a,r,y,s} = \frac{{C}^g_{a,r,y,s}}{\sum_a \sum_s {C}^g_{a,r,y,s}},
\]</span></p>
<p>if the multinomial distribution is assumed</p>
<p><span class="math display">\[
\boldsymbol{X}^g_{r,y} \sim \text{Multinomial}\left(\boldsymbol{\widehat{P}}^g_{r,y}\right)
\]</span></p>
<p>where, <span class="math inline">\(\boldsymbol{X}^g_{r,y} = \boldsymbol{P}^g_{r,y}N^{eff}_{r,y}\)</span> and <span class="math inline">\(\boldsymbol{P}^g_{r,y}\)</span> is the observed proportions, <span class="math inline">\(N^{eff}_{r,y}\)</span> is the effective sample size and <span class="math inline">\(\boldsymbol{P}^g_{r,y} = (P^g_{1,r,y,1}, \dots, P^g_{a_+,r,y,1}, P^g_{1,r,y,2}, \dots, P^g_{a_+,r,y,2})\)</span> is the vector of observed proportions across all ages and sexs in year <span class="math inline">\(y\)</span> and region <span class="math inline">\(r\)</span>, and <span class="math inline">\(\boldsymbol{\widehat{P}}^g_{r,y}\)</span> is the model fitted values which have the same dimension (<span class="math inline">\(\sum_a \sum_s \widehat{P}^g_{a,r,y,s} = 1\)</span>).</p>
</div>
<div id="catch-at-length" class="section level3 unnumbered hasAnchor">
<h3>Catch at length<a href="tagintegrated-model-equations.html#catch-at-length" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Catch at length observations are available for the trawl fishery. Model fitted values are derived by multiplying the catch at age (see above) by an age-length transition matrix denoted by <span class="math inline">\(\boldsymbol{A}^l_{y,s}\)</span> (dimensions of <span class="math inline">\(\boldsymbol{A}^l_{y,s}\)</span> are <span class="math inline">\(n_a \ \times \ n_l\)</span> and its rows must sum to 1),</p>
<p><span class="math display">\[\begin{equation}
  \widehat{\boldsymbol{Cl}}^g_{r,y,s} =  \left(\boldsymbol{A}^l_{y,s} \right)^T \ \times \ \widehat{\boldsymbol{C}}^g_{r,y,s}
\end{equation}\]</span>
where, <span class="math inline">\(\widehat{\boldsymbol{C}}^g_{r,y,s}\)</span> is a column vector of catch at age (dimension <span class="math inline">\(n_a \ \times \ 1\)</span>) at the beginning of year <span class="math inline">\(y\)</span> in region <span class="math inline">\(r\)</span> for sex <span class="math inline">\(s\)</span>, and <span class="math inline">\(\widehat{\boldsymbol{Cl}}^g_{r,y,s}\)</span> is a column vector of catch at length (dimension <span class="math inline">\(n_l \ \times \ 1\)</span>).</p>
</div>
<div id="proportions-at-age" class="section level3 unnumbered hasAnchor">
<h3>Proportions at age<a href="tagintegrated-model-equations.html#proportions-at-age" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Survey age composition data denoted by <span class="math inline">\({N}^s_{a,r,y,s}\)</span> is available for the longline survey where model fitted numbers are derived as,</p>
<p><span class="math display">\[\begin{equation}
  \widehat{N}^s_{a,r,y,s} = N_{a,r,y,s} \left(1 - \exp^{\delta_y Z_{a,r,y,s}}\right)S^s_{y,r,a,s}
\end{equation}\]</span>
where, <span class="math inline">\(\delta_y \in (0,1)\)</span> is the proportion of time in the year that the observation occurs during year <span class="math inline">\(y\)</span> and <span class="math inline">\(S^s_{y,r,a,s}\)</span> is the survey selectivity.</p>
</div>
<div id="relative-abundance-indices" class="section level3 unnumbered hasAnchor">
<h3>Relative abundance indices<a href="tagintegrated-model-equations.html#relative-abundance-indices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\begin{equation}
  \widehat{I}^s_{r,y} = \sum_s\sum_a \widehat{N}^s_{a,r,y,s} \bar{w}_{a,y,s}
\end{equation}\]</span>
where, <span class="math inline">\(\bar{w}_{a,y,s}\)</span> is mean weight at age, this can be omitted if the observation is in numbers i.e., abundance instead of biomass using <code>data$srv_dom_ll_obs_is_abundance = 1</code>. There are currently two likelihoods available for this observation</p>
<ul>
<li><p>if <code>data$srv_dom_ll_bio_comp_likelihood == 0</code>
<span class="math display">\[
ll_{r,y} = \frac{\left( \log {I}^s_{r,y} + 0.0001 - \log \widehat{I}^s_{r,y} + 0.0001 \right)^2}{2 \left( SE[{I}^s_{r,y}] / {I}^s_{r,y} \right)}
\]</span></p></li>
<li><p>if <code>data$srv_dom_ll_bio_comp_likelihood == 1</code>
<span class="math display">\[
ll_{r,y} = \frac{1}{{I}^s_{r,y} SE[{I}^s_{r,y}] \sqrt{ 2\pi}} \exp \left( - \frac{ \left(\log {I}^s_{r,y} - \log \widehat{I}^s_{r,y} - 0.5SE[{I}^s_{r,y}]^2\right)^2}{2 SE[{I}^s_{r,y}]^2}\right)
\]</span></p></li>
</ul>
<p>The catchability coefficient can also be calculated as a nuisance parameter instead of a free estimable parameter using the input <code>data$q_is_nuisance = 1</code>. This will solve the value for q in each region conditional on the other input free parameters. If the abundance or biomass observation is assumed to be lognormally distributed, then we can algebraically solve for the catchability coefficient.</p>
<p>For simplicity in the following equations we use <span class="math inline">\(E_i\)</span> to denote the model expected value <span class="math inline">\(O_i\)</span> to denote the observed value and <span class="math inline">\(\sigma_i\)</span> to denote the standard error for element <span class="math inline">\(i\)</span> of a series. In this case a time-series is within each region. So we will calculate a nuisance q for each region.</p>
<p>Technically, this derivation is only correct when <code>data$srv_dom_ll_bio_comp_likelihood == 1</code> however, it will be considered an approximation for the other likelihood. Assuming a specific element contributes to the negative log likelihood in the following manor,</p>
<p><span class="math display">\[
-ll = \sum_i log (\sigma_i) + 0.5\sum_i \bigg(\frac{log(O_i) - log(qE_i) + 0.5\sigma_i^2}{\sigma_i} \bigg)^2 \ ,
\]</span></p>
<p>then, if you differentiate this term with respect to <span class="math inline">\(q\)</span> you get
<span class="math display">\[
\frac{\partial }{\partial q}(-ll) = \frac{-1}{q} \sum_i\bigg( \frac{log(O_i/E_i) - log(q) + 0.5\sigma_i^2}{\sigma_i^2}\bigg) \,
\]</span></p>
<p>if you solve for when the derivative is zero (MLE estimate) then you obtain the following result</p>
<p><span class="math display">\[
\hat q = exp\frac{0.5n + S_3}{S_4} \,
\]</span>
where <span class="math inline">\(S_3 = \sum_i (log(O_i /E_I)/\sigma_i^2)\)</span> and <span class="math inline">\(S_4 = \sum_i(1/\sigma_i^2)\)</span>. <span class="math inline">\(E_i\)</span> in the initial calculation is derived assuming a <span class="math inline">\(q = 1\)</span>, before <span class="math inline">\(\hat q\)</span> is calculated.</p>
</div>
<div id="tag-recovery-observations" class="section level3 unnumbered hasAnchor">
<h3>Tag recovery observations<a href="tagintegrated-model-equations.html#tag-recovery-observations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When tagged fish are released in to the model partition they are tracked by the tag release event index denoted by <span class="math inline">\(k\)</span> for <span class="math inline">\(n_{T}\)</span> years after release. Due to tags being predominately recovered by the fixed gear fishery, all recoveries are assumed from the fixed gear fishery. A tag recovery observation will depend on if it is release conditioned or recapture conditioned. If tag-observations are release conditioned (the default) then for each release event there is a maximum of <span class="math inline">\(n_{T} \times n_r + 1\)</span> recovery possibilities, assuming the fixed gear fishery operates in all regions and all years we tracked the release event for. The plus one is for the not-recovered event, although it is not clear to me how this is different from a zero recovery event? (ask Dan). Let <span class="math inline">\(m\)</span> index a recovery event for a given release event and let <span class="math inline">\(n_{m|k} = n_{T} \times n_r + 1\)</span> where <span class="math inline">\(n_{m|k}\)</span> is the number of recovery events for release event <span class="math inline">\(k\)</span>. Let <span class="math inline">\(N^k_{m}\)</span> denote the number of tag-recoveries for a given release and recovery combination, and <span class="math inline">\(\boldsymbol{N^k} = (N^k_{1}, N^k_{2}, \dots, N^k_{n_{m|k}})^T\)</span> represents a vector of all possible observed recoveries for release event <span class="math inline">\(k\)</span>. Model fitted values for <span class="math inline">\(N^k_{m}\)</span> are calculated as</p>
<p><span class="math display">\[
\widehat{N}^k_{m} =  \sum_a \sum_s N^k_{a,r,y,s} \frac{F^{LL}_{a,r,y,s}}{Z_{a,r,y,s}} (1 - e^{-Z_{a,r,y,s}})\delta_y \ \ y,r \in m|k
\]</span>
where, <span class="math inline">\(N^k_{a,r,y,s}\)</span> is the number of tagged fish alive from tag-release event <span class="math inline">\(k\)</span>, and <span class="math inline">\(\delta_y\)</span> is the reporting rate in year <span class="math inline">\(y\)</span>.</p>
<p>There are three likelihoods used in the literature for tag-recoveries,</p>
<ul>
<li>The Poisson (<code>tag_likelihood = 0</code>)
<span class="math display">\[
N^k_{m} \sim \mathcal{Poisson}(\widehat{N}^k_{m})
\]</span></li>
<li>The Negative Binomial (<code>tag_likelihood = 1</code>)
<span class="math display">\[
N^k_{m} \sim \mathcal{NB}(\widehat{N}^k_{m}, \hat{\phi})
\]</span>
where, <span class="math inline">\(\hat{\phi}\)</span> is the estimable dispersion parameter</li>
<li>Multinomial (<code>tag_likelihood = 2</code>)
<span class="math display">\[
\boldsymbol{N^k}  \sim \text{Multinomial}\left(\boldsymbol{\hat{\theta}}^k, \text{Neff}^k\right)
\]</span>
All the recovery states include all regions, and years of recoveries including the non recaptured, where, <span class="math inline">\(\boldsymbol{\hat{\theta}}^k = (\hat{\theta}^k_1, \hat{\theta}^k_2\dots, \hat{\theta}^k_{n_{m|k}})\)</span> is the proportions of all recovery states <span class="citation">(<a href="#ref-vincent2020parameter" role="doc-biblioref">Vincent, Brenden, and Bence 2020</a>; <a href="#ref-goethel2014demonstration" role="doc-biblioref">Goethel, Legault, and Cadrin 2014</a>)</span>, with</li>
</ul>
<p><span class="math display">\[\begin{equation}
\hat{\theta}^{k}_{m} = \frac{\widehat{N}^k_{m}}{\sum_m \widehat{N}^k_{m}}
\end{equation}\]</span></p>
<p>For recapture conditioned tag-recovery observations, we calculate the probability of capture a fish at time <span class="math inline">\(t\)</span> being released in region <span class="math inline">\(r\)</span> and recovered in region <span class="math inline">\(r&#39;\)</span>. This was explored by <span class="citation">McGarvey and Feenstra (<a href="#ref-mcgarvey2002estimating" role="doc-biblioref">2002</a>)</span>. In this study they show how many of the terms can be dropped when describing the probability of that recovery event. The term <span class="math inline">\(S_i[a_t, a_m]\)</span> represents the probability of a tagged individual tagged at <span class="math inline">\(a_t\)</span> surviving until <span class="math inline">\(a_m\)</span>. In our model this surviorship will be regional specific, i.e., fish in certain regions will be exposed to higher fishing mortality rates than other regions over time.</p>
<p>Here, model predicted recaptures are recapture conditioned, which means the predicted proportions are year specific, and represent the proportion of recaptures in each region, <span class="math inline">\(\boldsymbol{\hat{\theta}}^k_y = (\hat{\theta}^{k}_{y,1},\dots, \hat{\theta}^k_{y,n_r})&#39;\)</span>
<span class="math display">\[\begin{equation}
\hat{\theta}^{k}_{y,r} = \frac{\widehat{N}^k_{r,y}}{\sum_r\widehat{N}^k_{r,y}}
\end{equation}\]</span></p>
<ul>
<li>How to deal with the high number of zeros in <span class="math inline">\(\boldsymbol{N^k}\)</span> zero inflated?</li>
</ul>
<p>These are derived for each recovery event (also year and region specific) denoted by the index <span class="math inline">\(m\)</span> and tag-release event by using the age-length key that was used to release each recovered fish to obtain an sex specific age-frequency. This age-frequency is then aged by the number of years this tag-recovery event was at liberty to derive observed tag-recoveries by age and sex.</p>
<p>This assumes the age-length conversion between releases and recoveries is consistent and allows us to use recovered fish with no length or sex recorded, but has the down side as mentioned earlier in the tag release section of smearing a single recovered fish across multiple age bins and sexes. However, it does mitigate the problem of going backwards and forwards through the age-length transition matrix, which appears to be more problematic.</p>
<ul>
<li>Multinomial (Not implemented)
<span class="math display">\[
{N}^k_{r,y} \sim \text{Multinomial}\left(\boldsymbol{\hat{\theta}}^k_y, \text{Neff}^k_y\right)
\]</span>
Here, model predicted recaptures are recapture conditioned, which means the predicted proportions are year specific, and represent the proportion of recaptures in each region, <span class="math inline">\(\boldsymbol{\hat{\theta}}^k_y = (\hat{\theta}^{k}_{y,1},\dots, \hat{\theta}^k_{y,n_r})&#39;\)</span>
<span class="math display">\[\begin{equation}
\hat{\theta}^{k}_{y,r} = \frac{\widehat{N}^k_{r,y}}{\sum_r\widehat{N}^k_{r,y}}
\end{equation}\]</span></li>
</ul>
<p>Release conditioned are defined as the proportion of recaptures over all states denoted as <span class="math inline">\(i\)</span>, for each release event. All the states, include all regions, and years of recoveries including the non recaptured, where, <span class="math inline">\(\boldsymbol{\hat{\theta}}^k = (\hat{\theta}^k_i, \hat{\theta}^k_2\dots, \hat{\theta}^k_{n_i}) = (\hat{\theta}^k_{1,1}, \hat{\theta}^k_{1,2}, \hat{\theta}^k_{2,2}, \dots, \hat{\theta}^k_{n_y,n_r}, \hat{\theta}^k_{NR})\)</span> is the proportions of all states <span class="citation">(<a href="#ref-vincent2020parameter" role="doc-biblioref">Vincent, Brenden, and Bence 2020</a>; <a href="#ref-goethel2014demonstration" role="doc-biblioref">Goethel, Legault, and Cadrin 2014</a>)</span>, with</p>
<p><span class="math display">\[\begin{equation}
\hat{\theta}^{k}_{i} = \frac{\widehat{N}^k_{i}}{\sum_i \widehat{N}^k_{i}}
\end{equation}\]</span></p>
</div>
</div>
<div id="likelihood-formulations" class="section level2 unnumbered hasAnchor">
<h2>Likelihood formulations<a href="tagintegrated-model-equations.html#likelihood-formulations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="multinomial" class="section level3 unnumbered hasAnchor">
<h3>Multinomial<a href="tagintegrated-model-equations.html#multinomial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This likelihood has no estimable parameters</p>
<p><span class="math display">\[
\boldsymbol{X} \sim \text{Multinomial}\left(\boldsymbol{\widehat{P}}\right)
\]</span></p>
<p>To avoid <span class="math inline">\(\widehat{P}_i = 0\)</span>, in which case the multinomial can be undefined if <span class="math inline">\(X_i = 0\)</span> all values of <span class="math inline">\(\widehat{P}_i\)</span> are run through a <code>posfun</code> function which adds a small constant and penalty to the likelihood. See this TMB issue <a href="https://github.com/kaskr/adcomp/issues/7">here</a> or Ben Bolker’s write up found <a href="https://github.com/bbolker/bbmisc/blob/master/posfun.pdf">here</a>.</p>
</div>
<div id="dirichlet-multinomial" class="section level3 unnumbered hasAnchor">
<h3>Dirichlet-Multinomial<a href="tagintegrated-model-equations.html#dirichlet-multinomial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Dirichlet-Multinomial distribution used for composition data, with input sample size denoted by <span class="math inline">\(n\)</span>, observed proportion for age <span class="math inline">\(a\)</span> denoted by <span class="math inline">\(p_a\)</span> and expected proportions denoted by <span class="math inline">\(\widehat{p}_a\)</span>. There is an estimable parameter denoted by <span class="math inline">\(\theta\)</span>. This follows the linear-parameterisation from <span class="citation">Thorson et al. (<a href="#ref-thorson2017model" role="doc-biblioref">2017</a>)</span>, with the following density function</p>
<p><span class="math display">\[\begin{equation}
f(x) = \frac{\Gamma\left(n + 1\right)}{\sum_a n{p}_a + 1}\frac{\Gamma\left(\theta n\right) }{\Gamma\left(n + \theta n\right)}\prod_{a} \frac{\Gamma\left(n {p}_a + n \theta \widehat{p}_a\right)}{\Gamma\left(n \theta \widehat{p}_a\right)}
\end{equation}\]</span></p>
<p>The effectictive sample size is calcualted as,</p>
<p><span class="math display">\[
n_{eff} = \frac{1 + \theta n}{1 + \theta}
\]</span></p>
<p>Simulating from this distribution is done by first simulating a dirichlet variable, using independent gamma draws (normalised), with shape parameter set as the expected proportion. Then draw from the multinomial with expected proportions based on the dirichlet draw.</p>
</div>
<div id="lognormal" class="section level3 unnumbered hasAnchor">
<h3>Lognormal<a href="tagintegrated-model-equations.html#lognormal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As mentioned in the abundance observation section there are two alternative lognormal forms in the model. Pearon residuals are calculated as</p>
<p><span class="math display">\[
r_i = \frac{log(O_i/E_i) + 0.5\sigma_i^2}{\sigma_i}
\]</span></p>
</div>
</div>
<div id="projecting" class="section level2 unnumbered hasAnchor">
<h2>Projecting<a href="tagintegrated-model-equations.html#projecting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="recruitment-1" class="section level3 unnumbered hasAnchor">
<h3>Recruitment<a href="tagintegrated-model-equations.html#recruitment-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two methods for future recruitment, parametric and empirical. Parametric will simulate from the the lognormal distribution with <span class="math inline">\(\sigma_R\)</span>. Empirical will resample input recruitment deviations between certain years</p>
<ul>
<li><p>Parametric <code>future_recruitment_type == 0</code>
<span class="math display">\[
\epsilon_y \sim \mathcal{N}\left(0, \sigma_R^2 \right)
\]</span>
resulting recruitment multipliers, also termed year class strengths (<span class="math inline">\(YCS_y\)</span>) are bias adjusted <span class="math inline">\(YCS_y = \exp(\epsilon_y - 0.5\sigma_R^2)\)</span></p></li>
<li><p>Empirical <code>future_recruitment_type == 1</code> this will sample with replacement input recruitment deviations between the values specified in <code>year_ndx_for_empirical_resampling</code>. Note elements of <code>year_ndx_for_empirical_resampling</code> are C++ vector dimensions. If <code>year_ndx_for_empirical_resampling = c(0,n_years - 1)</code> this will resample from all input recruitment deviations. if <code>year_ndx_for_empirical_resampling = c(0,9)</code> this will resample from the first 10 input recruitment deviations. if <code>year_ndx_for_empirical_resampling = c((n_years - 9):(n_years - 1))</code> this will resample from the last 10 input recruitment deviations.</p></li>
<li><p>Deterministic recruitment <code>future_recruitment_type == 2</code>. This will assume <span class="math inline">\(YCS_y = 1\)</span> which result in the model applying mean recruitment for all future years</p></li>
</ul>
</div>
<div id="fishing" class="section level3 unnumbered hasAnchor">
<h3>Fishing<a href="tagintegrated-model-equations.html#fishing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fishing selectivity that was assumed in the last year of the model is used during the projection period. There are two methods users can use for future fishing, assume fishing mortality rates or catches.</p>
<ul>
<li><p>User specifies F values during projection (unlikely useage) <code>future_fishing_type = 0</code> populate <code>future_fishing_inputs_trwl</code> and <code>future_fishing_inputs_fixed</code> with F values</p></li>
<li><p>User specifies Catch values during projection (more likely) <code>future_fishing_type = 1</code> populate <code>future_fishing_inputs_trwl</code> and <code>future_fishing_inputs_fixed</code> with future catches. An F is calculated based on the hybrid fishing mortality method, which should result in predicted catches close to these but not exact.</p></li>
</ul>
</div>
<div id="example-code-snippets" class="section level3 unnumbered hasAnchor">
<h3>Example code snippets<a href="tagintegrated-model-equations.html#example-code-snippets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tagintegrated-model-equations.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## once you have done MLE and evaluated fits to a model</span></span>
<span id="cb17-2"><a href="tagintegrated-model-equations.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## then you can running the following code to find</span></span>
<span id="cb17-3"><a href="tagintegrated-model-equations.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## deterministic reference points based on %B0</span></span>
<span id="cb17-4"><a href="tagintegrated-model-equations.html#cb17-4" aria-hidden="true" tabindex="-1"></a>n_proj_years <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb17-5"><a href="tagintegrated-model-equations.html#cb17-5" aria-hidden="true" tabindex="-1"></a>regional_spr <span class="ot">=</span> <span class="fu">find_regional_Fspr</span>(<span class="at">data =</span> data, </span>
<span id="cb17-6"><a href="tagintegrated-model-equations.html#cb17-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">MLE_report =</span> mle_report, <span class="at">n_years_for_fleet_ratio =</span> <span class="dv">5</span>, </span>
<span id="cb17-7"><a href="tagintegrated-model-equations.html#cb17-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">percent_Bzero =</span> <span class="dv">40</span>, <span class="at">n_future_years =</span> n_proj_years, <span class="at">verbose =</span> T)</span>
<span id="cb17-8"><a href="tagintegrated-model-equations.html#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="tagintegrated-model-equations.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># setup projection data</span></span>
<span id="cb17-10"><a href="tagintegrated-model-equations.html#cb17-10" aria-hidden="true" tabindex="-1"></a>proj_data <span class="ot">=</span> <span class="fu">setup_proj_data</span>(<span class="at">mle_obj =</span> mle_obj, <span class="at">n_proj_years  =</span> <span class="dv">100</span>)</span>
<span id="cb17-11"><a href="tagintegrated-model-equations.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="do">## use the Fs from Fspr function</span></span>
<span id="cb17-12"><a href="tagintegrated-model-equations.html#cb17-12" aria-hidden="true" tabindex="-1"></a>proj_data<span class="sc">$</span>future_fishing_inputs_trwl <span class="ot">=</span> <span class="fu">matrix</span>(regional_spr<span class="sc">$</span>Fspr <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> regional_spr<span class="sc">$</span>fixed_gear_F_proportion), </span>
<span id="cb17-13"><a href="tagintegrated-model-equations.html#cb17-13" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">byrow =</span> F, <span class="at">ncol =</span> n_proj_years, <span class="at">nrow =</span> n_regions)</span>
<span id="cb17-14"><a href="tagintegrated-model-equations.html#cb17-14" aria-hidden="true" tabindex="-1"></a>proj_data<span class="sc">$</span>future_fishing_inputs_fixed <span class="ot">=</span> <span class="fu">matrix</span>(regional_spr<span class="sc">$</span>Fspr <span class="sc">*</span> regional_spr<span class="sc">$</span>fixed_gear_F_proportion, </span>
<span id="cb17-15"><a href="tagintegrated-model-equations.html#cb17-15" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">byrow =</span> F, <span class="at">ncol =</span> n_proj_years, <span class="at">nrow =</span> n_regions)</span>
<span id="cb17-16"><a href="tagintegrated-model-equations.html#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="tagintegrated-model-equations.html#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># check projection data</span></span>
<span id="cb17-18"><a href="tagintegrated-model-equations.html#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">validate_input_data_and_parameters</span>(<span class="at">data =</span> proj_data, <span class="at">parameters =</span> parameters)</span>
<span id="cb17-19"><a href="tagintegrated-model-equations.html#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># build proj object</span></span>
<span id="cb17-20"><a href="tagintegrated-model-equations.html#cb17-20" aria-hidden="true" tabindex="-1"></a>proj_obj <span class="ot">&lt;-</span> <span class="fu">MakeADFun</span>(proj_data, parameters, <span class="at">map =</span> map_fixed_pars,</span>
<span id="cb17-21"><a href="tagintegrated-model-equations.html#cb17-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">DLL=</span><span class="st">&quot;SpatialSablefishAssessment_TMBExports&quot;</span>, <span class="at">hessian =</span> T, <span class="at">silent =</span> T)</span>
<span id="cb17-22"><a href="tagintegrated-model-equations.html#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># run the projection model with future F&#39;s and MLE parameter values</span></span>
<span id="cb17-23"><a href="tagintegrated-model-equations.html#cb17-23" aria-hidden="true" tabindex="-1"></a>proj_rep <span class="ot">=</span> proj_obj<span class="sc">$</span><span class="fu">report</span>(mle_spatial<span class="sc">$</span>par)</span>
<span id="cb17-24"><a href="tagintegrated-model-equations.html#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the depletion levels are as expected</span></span>
<span id="cb17-25"><a href="tagintegrated-model-equations.html#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_SSB</span>(<span class="at">MLE_report =</span> proj_rep, <span class="at">region_key =</span> region_key, <span class="at">depletion =</span> T) <span class="sc">+</span></span>
<span id="cb17-26"><a href="tagintegrated-model-equations.html#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb17-27"><a href="tagintegrated-model-equations.html#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb17-28"><a href="tagintegrated-model-equations.html#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="tagintegrated-model-equations.html#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="do">## once this checks out, you should run projections with stochasticity in recruitment and parameters estimates</span></span>
<span id="cb17-30"><a href="tagintegrated-model-equations.html#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="do">## to get projected quantities with uncertainty.</span></span></code></pre></div>
</div>
</div>
<div id="symbol-notation" class="section level2 unnumbered hasAnchor">
<h2>Symbol Notation<a href="tagintegrated-model-equations.html#symbol-notation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y\)</span></td>
<td>Year index</td>
</tr>
<tr class="even">
<td><span class="math inline">\(T\)</span></td>
<td>Terminal year of the model</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s\)</span></td>
<td>Sex index <span class="math inline">\(s \in \{1,2\}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(a\)</span></td>
<td>Model age cohort, i.e., <span class="math inline">\(a = a_0, a_0 + 1, \dots\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_{1}\)</span></td>
<td>Recruitment age to the model = 2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_+\)</span></td>
<td>Plus-group age class (oldest age considered plus all older ages)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n_a\)</span></td>
<td>Number of age classes modeled <span class="math inline">\(a_+ \ - a_1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(l\)</span></td>
<td>length class</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n_l\)</span></td>
<td>Number of length classes</td>
</tr>
<tr class="even">
<td><span class="math inline">\(g\)</span></td>
<td>gear type index, i.e. longline survey, fixed gear fishery, trawl fishery</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x\)</span></td>
<td>log-likelihoos index</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{w}_{a,y, s}\)</span></td>
<td>Average weight at age <span class="math inline">\(a\)</span>, year <span class="math inline">\(y\)</span> and sex <span class="math inline">\(s\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\phi_{a,y}\)</span></td>
<td>Proportion of female mature by age and year</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p^s_{y}\)</span></td>
<td>Proportion of recruits for sex <span class="math inline">\(s\)</span>. Often assumed = 0.5</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\ln \mu_{r}\)</span></td>
<td>Average log-recruitment</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p^R_y\)</span></td>
<td>proportion recruitment male</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\ln \mu_{f}\)</span></td>
<td>Average log-fishing mortality</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\phi_{y,g}\)</span></td>
<td>annual fishing mortality deviation by gear (log space)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\tau_{y}\)</span></td>
<td>annual recruitment deviation <span class="math inline">\(\sim LogNormal\left(0,\sigma_r\right)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma_r\)</span></td>
<td>Recruitment standard deviation</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(N_{a,y,s}\)</span></td>
<td>Numbers of fish at age <span class="math inline">\(a\)</span> in year <span class="math inline">\(y\)</span> of sex <span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(M\)</span></td>
<td>Natural mortality</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(F^g_{a,y}\)</span></td>
<td>Fishing mortality for year <span class="math inline">\(y\)</span>, age <span class="math inline">\(a\)</span> and gear <span class="math inline">\(g\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(F_{hist}\)</span></td>
<td>Historical proportion of Fishing mortality</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Z_{a,y}\)</span></td>
<td>Total mortality for year <span class="math inline">\(y\)</span>, age <span class="math inline">\(a\)</span> <span class="math inline">\(=\sum\limits_g F^g_{a,y} + M\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(R_{y}\)</span></td>
<td>Annual recruitment</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(B_{y}\)</span></td>
<td>Spawning biomass in year <span class="math inline">\(y\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(S^g_{a,y,s}\)</span></td>
<td>Selectivity at age <span class="math inline">\(a\)</span> for gear type <span class="math inline">\(g\)</span> and sex <span class="math inline">\(s\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_50\)</span></td>
<td>age at 50% selection for ascending limb</td>
</tr>
<tr class="even">
<td><span class="math inline">\(d_50\)</span></td>
<td>age at 50% selection for descending limb</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\delta\)</span></td>
<td>slope/shape parameters for different logistic curves</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\boldsymbol{A}\)</span></td>
<td>ageing-error matrix dimensions <span class="math inline">\(n_a \ \times \ n_a\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\boldsymbol{A}^l_s\)</span></td>
<td>age to length conversion matrix by sex. dimensions <span class="math inline">\(n_a \ \times \ n_l\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(q_g\)</span></td>
<td>abundance index catchability coeffecient by gear</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\lambda_x\)</span></td>
<td>Statistical weight (penalty) for component <span class="math inline">\(x\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(P^g_{l,y,s}\)</span></td>
<td>Observed proportions at length for gear <span class="math inline">\(g\)</span> in year <span class="math inline">\(y\)</span> and sex <span class="math inline">\(s\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(P^g_{a,y,s}\)</span></td>
<td>Observed proportions at age for gear <span class="math inline">\(g\)</span> in year <span class="math inline">\(y\)</span> and sex <span class="math inline">\(s\)</span></td>
</tr>
</tbody>
</table>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-goethel2014demonstration" class="csl-entry">
Goethel, Daniel R, Christopher M Legault, and Steven X Cadrin. 2014. <span>“Demonstration of a Spatially Explicit, Tag-Integrated Stock Assessment Model with Application to Three Interconnected Stocks of Yellowtail Flounder Off of New England.”</span> <em>ICES Journal of Marine Science</em> 72 (1): 164–77.
</div>
<div id="ref-mcgarvey2002estimating" class="csl-entry">
McGarvey, Richard, and John E Feenstra. 2002. <span>“Estimating Rates of Fish Movement from Tag Recoveries: Conditioning by Recapture.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 59 (6): 1054–64.
</div>
<div id="ref-thorson2017model" class="csl-entry">
Thorson, James T, Kelli F Johnson, Richard D Methot, and Ian G Taylor. 2017. <span>“Model-Based Estimates of Effective Sample Size in Stock Assessment Models Using the Dirichlet-Multinomial Distribution.”</span> <em>Fisheries Research</em> 192: 84–93.
</div>
<div id="ref-vincent2020parameter" class="csl-entry">
Vincent, Matthew T, Travis O Brenden, and James R Bence. 2020. <span>“Parameter Estimation Performance of a Recapture-Conditioned Integrated Tagging Catch-at-Age Analysis Model.”</span> <em>Fisheries Research</em> 224: 105451.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="how-to-use-spatialsablefishassessment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tagintegrated-data-and-parameter-descriptions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Craig44/SpatialSablefishAssessment/edit/main/03-TagIntegratedModel.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
